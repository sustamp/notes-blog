---
# layout: post
layout: post-custom
title: "系统架构师教程学习笔记"
---

>**万时定律**，10000小时定律。  
简单来说，要成为某个领域顶尖的专业人才，需要10000小时持续不断的练习。例如小提琴、足球、国际象棋、围棋等领域，无一例外都遵循这个定律。  
技术人员的成长需要对技术的热情和持续不断学习，思考，实践和总结。

本文目录：
- [前言](#前言)
- [发展历程](#发展历程)
  - [1.基础分析阶段（1968-1994）](#1基础分析阶段1968-1994)
  - [2.概念体系的建立和核心技术形成阶段（1999-2000）](#2概念体系的建立和核心技术形成阶段1999-2000)
  - [3.理论体系完善与发展阶段（1996年至今）](#3理论体系完善与发展阶段1996年至今)
  - [4.普及应用阶段（2000年至今）](#4普及应用阶段2000年至今)
- [软件架构的常用分类及建模方法](#软件架构的常用分类及建模方法)
  - [1.软件架构的常用分类](#1软件架构的常用分类)
    - [1.分层架构（LA）](#1分层架构la)
    - [2.事件驱动架构（EDA）](#2事件驱动架构eda)
    - [3.微核架构](#3微核架构)
    - [4.微服务架构](#4微服务架构)
    - [5.云架构](#5云架构)
  - [2.软件架构的常用建模方法](#2软件架构的常用建模方法)
- [第2章 计算机系统基础知识](#第2章-计算机系统基础知识)
  - [2.1 计算机硬件](#21-计算机硬件)
    - [处理器](#处理器)
    - [存储器](#存储器)
    - [总线](#总线)
    - [接口](#接口)
    - [外部设备](#外部设备)
  - [2.2 计算机软件](#22-计算机软件)
    - [2.2.1 操作系统](#221-操作系统)
    - [1.操作系统的组成](#1操作系统的组成)
    - [2.操作系统的作用](#2操作系统的作用)
    - [3.操作系统的特征](#3操作系统的特征)
    - [4.操作系统的分类](#4操作系统的分类)
    - [2.2.2 数据库](#222-数据库)
    - [2.2.3 文件系统](#223-文件系统)
    - [2.2.4 网络协议](#224-网络协议)
    - [2.2.5 中间件](#225-中间件)
    - [2.2.6 软件构件](#226-软件构件)
    - [1.软件构件的组装模型](#1软件构件的组装模型)
    - [2.商用构件的标准规范](#2商用构件的标准规范)

--------
## 前言
系统架构（System Architecture）是系统的一种整体的高层次的结构表示，是系统的骨架和根级，支撑和链接各个部分。

系统架构设计的主要目的是对需要开发的系统进行一系列的抽象，用于系统各个方面的设计与实现。设计的优劣决定了系统的健壮性和生命周期的长短。

**架构设计**是需求系统开发过程中**需求分析**阶段后的一个关键步骤。架构设计的作用主要包括以下几点：
- 解决相对复杂的需求分析问题。（复杂需求）
- 解决非功能属性在系统占据重要位置的设计问题。（非功能）
- 解决生命周期长、拓展性需求高的系统整体结构问题。（周期长，拓展高）
- 解决系统基于组件需要的集成问题。（组件集成）
- 解决业务流程再造难的问题。（再造）

--------
## 发展历程

### 1.基础分析阶段（1968-1994）

随着软件规模的增大，模块化开发方法被逐步采用，为后续软件架构的发展奠定了基础。

模块化方法采用对复杂事物分而治之的经典原则。涉及的问题是模块设计的规则，即怎么将系统分解成模块。

每一模块都可独立开发与测试，最后在组装成一个完整软件。

将系统分解为模块，应该遵循以下规则：
1. 最高模块内聚。
   也就是一个模块内部的元素最大限度的关联，只实现一种功能的模块是高内聚的，具有三种以上功能的模块则是低内聚的。
2. 最低耦合。
   不同模块之间的关系尽可能弱，以利于软件的升级和拓展。
3. 模块大小适度。
   颗粒度大，内部维护困难；
   颗粒度小，模块间耦合会增加。
4. 模块调用链的深度（嵌套层次）不可过多。
5. 接口简单精炼，具有信息隐蔽能力。
6. 尽可能地复用已有模块。

### 2.概念体系的建立和核心技术形成阶段（1999-2000）

2000年，IEEE标准第一次定义了软件架构的形式化标准，这标志着软件架构的理论体系基本建立，具备普及应用的基础。

这一阶段的重要成功之一是：软件组件化技术。提升软件重用能力和质量。

组件的特性：
- 可组装型和可插拔行。
- 组价与组件之间不存在直接耦合关系。
- 组件和组价之间又并非绝对独立，可经过组装后与其他组件进行业务上的交互。

组件化开发并不等同于模块化开发。模块化开发只是在逻辑上做了切分，代码通常并没有真正意义上的隔离。

组件化也不等同于应用集成，应用集成是将一些基于不同平台或不同方案的应用软件有机集成到一个无缝的、并列的、易于访问的单一系统中，以建立一个统一的综合应用。

组件化比模块化更独立，但比应用集成结合得更加紧密。

### 3.理论体系完善与发展阶段（1996年至今）

在这一阶段，各种方法论都在发展，主要集中在软件架构的如下几个方面：
- 描述与表示；
- 分析、设计和测试；
- 发现、演化和重用；
  软件架构发现属于逆向工程，解决如何从已存在的系统中提取软件架构的问题。
  软件架构演化是出于需求、技术、环境和分布的变化而导致架构变动。
- 开发方法；
  软件开发模型是跨越整个软件生存周期的，从开发、运行和维护所实施的全部工作和任务的结构框架。一般有三种：
  - 瀑布模型。以软件需求完全确认为前提。
  - 渐进式开发模型。如螺旋模型等，在软件开发初期只能提供基本需求为前提。
  - 变换模型。以形式化开发方法为基础。
- 架构风格；
  架构风格（架构模式）是针对给定场景中经常出现的问题提供的一般性可重用方案，反映的是领域中众多系统中共有的结构和语义特征，并指导如何将各个子模块和子系统有效地组成一个完整的系统。
  分类：
  - 数据流风格。
  - 调用/返回风格。
  - 独立组件风格。
  - 虚拟机风格
  - 仓库风格。
- 动态软件架构。

### 4.普及应用阶段（2000年至今）

软件架构是软件生命周期的重要产物，它影响软件开发的各个阶段：
- 需求阶段。
- 设计阶段。
- 实现阶段。
- 维护阶段。

--------
## 软件架构的常用分类及建模方法

### 1.软件架构的常用分类

目前已形成的满足不同用途的架构模式，比较典型的有分层架构、事件驱动架构、微核架构、微服务架构和云架构等五类。此外像C/S、B/S、管道-过滤器和PAC等架构也是被广泛使用的。

#### 1.分层架构（LA）

Layered Architecture是最常见、也是事实上的标准架构。层与层之间通过接口进行通信，每一层都有清晰的角色和分工。

最常见的四层结构：
- 表示层（Presentation Layer）。
- 业务层（Business Layer）。
- 持久层（Presistence Layer）。提供数据，SQL语句在这一层。
- 数据层（Database Layer）。保存数据。
  
有的项目在业务层和持久层之间加了一个服务层（Service），提供不同业务逻辑需要的一些通用接口。

#### 2.事件驱动架构（EDA）

Event-Driven Architecture，Event是状态发生变化时软件发出的通知。事件驱动架构是通过时间进行通信的软件架构。它分成四个部分：
- 事件队列（Event Queue）：接收事件的入口。
- 分发器（Event Mediator）：将不同的事件分发到不同的业务逻辑单元。
- 事件通道（Event Channel）：分发器与处理器的联系渠道。
- 事件处理器（Event Processor）：实现业务逻辑，处理完成后会发出事件，触发下一步操作。

对于简单的项目，事件队列、分发、通道可以合为一体，整个软件就分成时间代理和事件处理器两部分。

观察者模式常被叫做发布-订阅模式，事件驱动架构是观察者模式的一种最佳实践，常应用于商品系统，物流系统，监控系统，运营数据分析系统等。

#### 3.微核架构

微核架构（Microkernel Architecture）又称为插件架构（Plug-in Architecture），是指软件的内核相对较小，主要功能和业务逻辑都通过插件实现。

内核（Core）通常只包含系统运行的最小功能。插件则是相互独立的，插件之间的通信应该减少到最低，避免出现互相依赖的问题。

#### 4.微服务架构

Microservices Architecture是服务导向架构（Service-Oriented Architecture，SOA）的升级。每个服务都是一个独立的部署单元（Separately Deployed Unit）。这些单元都是分布式的，互相解耦，通过远程通信协议（如REST、SOAP）联系。

微服务架构分成三种实现模式：
- RESTful API模式：服务通过API提供，云服务就属于这一类。
- RESTful 应用模式：服务通过传统的网络协议或应用协议提供，背后通常是一个多功能的应用程序，常见于企业内部。
- 集中消息模式：采用消息代理（Message Broker）实现消息队列、负载均衡、统一日志和异常处理，缺点是会出现单点失败，消息代理可能要做成集群。
  


#### 5.云架构

Cloud Architecture主要解决拓展性和并发的问题。

云架构主要分成两部分：
- 处理单元。实现业务逻辑。
- 虚拟中间件。负责通信、保持会话控制、数据复制、分布式处理和部署管理。
  

### 2.软件架构的常用建模方法

1. 结构模型

2. 框架模型

3. 动态模型

4. 过程模型

4种模型并不完全独立，通常需要互相组合来形成一个可以刻画软件架构的完整模型。

--------
## 第2章 计算机系统基础知识

--------
### 2.1 计算机硬件

计算机组成结构源于冯·诺依曼计算机结构。

#### 处理器

计算机系统运算和控制核心部件。

位宽：4位 -> 64位。    
内核：单核 -> 多核、异构多核、众核。  
指令集：CISC, RISC。RISC为趋势，化繁为简。  

典型的处理器系统结构：

--------------------指令部件----------------  
-----------运算部件--寄存器--存储部件  
---------------------Cache部件--MMU部件  
--完成部件  
---------------------地址总线--------  
---------------------数据总线--------  

#### 存储器

存储器分为：
- 内存储器  
  - ROM（只读存储器）
  - RAM（随机存储器）
    - 1)片上缓存。SRAM结构，处理器直接集成的缓存。16~512KB。
    - 2)片外缓存。SRAM结构。256kb~4MB，可称L2Cache/L3Cache/PlatformCache
    - 3)主存（内存）。DRAM结构，以独立部件/芯片存在，通过总线与处理器链接。容量：数百M~数十GB。
- 外存储器  
  Flash < 10年
  光盘 0 < y < n * 10年
  磁盘 > 10年
  磁带 > 30年

#### 总线

计算机**部件间**遵循某一特定协议实现**数据交换**的**形式**。

按位置划分为内总线，系统总线和外部总线。

内总线用于芯片内部互联。

系统总线是计算机中CPU、主存、IO接口的总线。

外部总线又称为通信总线，是计算机板和外部设备之间，或计算机系统之间互联的总线。

总线性能指标：
- 总线带宽
- 总线服务质量（QoS，Quality of Service）
- 总线时延
- 总线抖动

#### 接口

计算机不同层之间的通信规则。

例如有显示接口HDMI/DVI/VGA，音频输入输出接口TRS/RCA/XLR，网络接口 RJ45/FC，USB接口，SATA接口，打印机接口等等。


#### 外部设备

外围设备，如鼠标，键盘，显示器，摄像头或其他移动穿戴设备。

--------
### 2.2 计算机软件

软件是指在系统上运行的**程序**、相关**文档**和**数据**的**集合**。按作用和运行环境分为**系统软件**和**应用软件**两大类。

#### 2.2.1 操作系统

操作系统是计算机系统的资源管理者，包含对软、硬件资源实施管理的一组程序。旨在合理共享和利用资源，发挥工作效率，提升处理性能。

#### 1.操作系统的组成

通常由操作系统内核和其他许多附加的配套软件组成。

操作系统内核指的是能提供**进程管理**、**存储管理**、**文件管理**和**设备管理**等功能的软件模块。

#### 2.操作系统的作用

- 管理计算中运行的程序和分配各种软硬件资源。
- 为用户提供友善的人机界面
- 为应用程序的开发和运行提供一个高效率的平台。
- 其他作用：辅导用户操作，监控系统性能等。

#### 3.操作系统的特征

- 并发性
  单核CPU的并发性是指在一段时间内，宏观上多个任务是并发执行的。
  多核CPU则可将多个程序分配到不同的CPU执行。
- 不确定性
  多个进程并发执行，但具体到何时执行，何时完成的时间并不是确定的，经常可能要等待资源或事件的发生而获得CPU的执行能力。"走走停停"。
- 共享性
  同时共享和互斥共享。多用户程序共用一套计算机系统的所有资源。
- 虚拟性
  将物理实体变为逻辑上的多个对应物，方便用户使用和操作。

#### 4.操作系统的分类

1. 批处理系统
   最早的操作系统之一，通常不具备交互性。通常是将设定好的一批作业交给系统操作员输入计算机后，由系统控制它们自动运行。

   典型产品IBM OS/360和OS/390
   
2. 分时操作系统
   允许多个用户同时访问计算机资源的操作系统。这话总操作系统将CPU的工作时间划分为许多很短的时间片，轮流分配给每个用户使用。

   典型产品：UNIX。
   
3. 实时操作系统
   对外来信息以足够快的速度进行处理。对交付能力要求不高，但可靠性要保证。

   典型产品：
   - 实时控制系统：数据采集、武器控制、飞机自动驾驶、导弹制导系统等。
   - 信息处理系统：飞机订票系统，情报检索等。

4. 网络操作系统
   网络操作系统使联网计算机能方便而有效地**共享网络资源**。
   
   常见的网络操作系统有Windows系列、Linux、Unix
   
5. 分布式操作系统
   多个分散的计算机连接而成的计算机系统。是网络操作系统的更高级形式，同时还有透明性、可靠性和高性能等特性。
   
   
6. 微型计算机操作系统
   
   常见的有Windows、MacOS、Linux。

7. 嵌入式操作系统
   运行在嵌入式智能设备中。主要特点是：
   - 微型化。
   - 可定制。
   - 实时性。
   - 可靠性。
   - 易移植。
  常见的嵌入式实时操作系统有VxWorks，Clinux，PaleOS，WindowsCE等。
  
#### 2.2.2 数据库

数据库是指长期存储在计算机内的，有组织的、统一管理的相关数据的集合。

目前最常见的是关系型数据库和非关系型数据库。

#### 2.2.3 文件系统
文件系统是指操作系统中实现文件统一管理的一组软件和相关数据的集合。

#### 2.2.4 网络协议
不同系统或终端之间要实现信息交换或资源分享，需要具备**共同能够理解的语言**，这就是网络协议。

网络协议规定了通信时的数据格式、传送时序、控制信息、应答信号等内容。

常用的网络协议有：
LAN、WAN、WIFI、移动网协议
互联网使用的是TCP/IP协议族。

#### 2.2.5 中间件
承担应用软件在不同系统上可顺利运行的中介，所以叫中间件，它作为应用软件与各种操作系统之间使用的**标准化**编程**接口和协议***。

中间件分类：
- 消息中间件。
  如IBMMQ，ActiveMQ，Kafka等。
- 事务处理（交易）中间件。
  每项事务在多台应用服务器间协调完成。如Tuxedo。
- 数据存取中间件
  经常用于分布式系统中，为虚拟缓冲存取、格式转换、解压等带来方便
- Web服务器中间件
- 安全中间件
- 跨平台和架构的中间件
- 专用平台中间件
- 网络中间件
  
#### 2.2.6 软件构件
构件/组件：一个程序集或一组程序的集合。

构件提供接口供外部来访问，外部不能直接操作构件的内部。

构建的2个重要特性：
- 自包容
- 可重用
  
#### 1.软件构件的组装模型

搭积木式的开发，即构建组装。

通过需求分析 -> 设计构建组装结构，明确各构件之间的关系 ->  建立构件库 -> 开发/应用构件（独立开发、重用、使用第三方构件等） -> 测试与发布

优点：
- 自包容。构建之间通过接口访问，相互独立。
- 可重用。设计良好的构建容易被重用。降低开发成本。
- 颗粒度小。相对整个系统，构建颗粒度小，开发任务更加灵活，各个构建都可进行独立并行开发。
  
缺点：
- 需要经验丰富的架构设计师。否则结构设计不良，重用性也会降低。
- 性能上会有让步。考虑构建的独立性和重用性，会导致其他方面做出让步，最明显的就是性能。
- 有学习成本。需要程序员熟练掌握构件开发和组装。
- 软件质量不好控制。第三方的构件库质量会最终影响软件质量，而第三方构件库通常很难控制。（木桶原理：木桶容量是根据最短的那块木板决定的）

#### 2.商用构件的标准规范
1. CORBA
2. J2EE
3. DNA
