---
# layout: post
layout: post-custom
title: "系统架构师教程学习笔记"
---

>**万时定律**，10000小时定律。  
简单来说，要成为某个领域顶尖的专业人才，需要10000小时持续不断的练习。例如小提琴、足球、国际象棋、围棋等领域，无一例外都遵循这个定律。  
技术人员的成长需要对技术的热情和持续不断学习，思考，实践和总结。

## 考试大纲

<a href="https://sustamp.github.io/notes-blog/2025/03/20/ruankao-outline.html" target="_blank">架构设计师考试大纲</a>

## 前言
系统架构（System Architecture）是系统的一种整体的高层次的结构表示，是系统的骨架和根级，支撑和链接各个部分。

系统架构设计的主要目的是对需要开发的系统进行一系列的抽象，用于系统各个方面的设计与实现。设计的优劣决定了系统的健壮性和生命周期的长短。

**架构设计**是需求系统开发过程中**需求分析**阶段后的一个关键步骤。架构设计的作用主要包括以下几点：
- 解决相对**复杂的需求**分析问题。
- 解决**非功能**属性在系统占据重要位置的设计问题。
- 解决生命**周期长**、**拓展**性需求**高**的系统整体结构问题。
- 解决系统基于**组件**需要的**集成**问题。
- 解决业务**流程再造**难的问题。


## 发展历程

|阶段|要点|
|----|----|
|基础分析阶段|**模块化开发方法**|
|概念体系和核心技术形成阶段|成果：**软件组件化技术**。组件具有可组装性和可插拔性。|
|理论体系完善与发展阶段|随着基于软件组件架构理论的建立，与之相关的一些研究方向组件成为软件工程领域的研究重点|
|普及应用阶段|**软件架构**是软件生命周期中的重要产物，它影响软件开发的各个阶段|


### 1.基础分析阶段（1968-1994）

随着软件规模的增大，**模块化开发**方法被逐步采用，为后续软件架构的发展奠定了基础。

模块化方法采用对复杂事物分而治之的经典原则。涉及的问题是模块设计的规则，即怎么将系统分解成模块。

每一模块都可独立开发与测试，最后在组装成一个完整软件。

将系统分解为模块，应该遵循以下规则：
1. **高**内聚。  
   - 只实现一种功能的模块是高内聚的，具有三种以上功能的模块则是低内聚的。也就是一个模块内部的元素最大限度的关联，
1. **低**耦合。
   - 不同模块之间的关系尽可能弱，以利于软件的升级和拓展。
2. 模块**大小适度**。
   - 颗粒度大，内部维护困难；
   - 颗粒度小，模块间耦合会增加。
3. 模块**调用链**的嵌套层次**不**可过**多**。
4. **接口简单**精炼，具有信息隐蔽能力。
5. 尽可能地**复用**已有模块。

### 2.概念体系的建立和核心技术形成阶段（1999-2000）

2000年，IEEE标准第一次定义了软件架构的形式化标准，这标志着软件架构的理论体系基本建立，具备普及应用的基础。

这一阶段的重要成功之一是：软件**组件化技术**。提升软件**重用**能力和**质量**。

组件的特性：
- **可组装性**和**可插拔性**。
- 组价与组件之间不存在直接耦合关系。
- 组件和组价之间又并非绝对独立，可经过组装后与其他组件进行业务上的交互。

组件化开发与模块化开发区分：
- 组件化开发并不等同于模块化开发。模块化开发只是在逻辑上做了切分，代码通常并没有真正意义上的隔离。

组件化与应用集成区分：
- 组件化也不等同于应用集成，应用集成是将一些基于不同平台或不同方案的应用软件有机集成到一个无缝的、并列的、易于访问的单一系统中，以建立一个统一的综合应用。

组件化比模块化更独立，但比应用集成结合得更加紧密。

> 模块化开发 < (独立性) **组件化开发** (结合度) > 应用集成

### 3.理论体系完善与发展阶段（1996年至今）

随着基于软件组件架构理论的建立，与之相关的一些研究方向逐渐成为软件工程领域的研究重点，主要包括：
- **软件架构描述与表示**；
- **软件架构分析、设计和测试**；
- **软件架构发现、演化和重用**；
  - 软件架构发现属于逆向工程，解决如何从已存在的系统中提取软件架构的问题。
  - 软件架构演化是出于需求、技术、环境和分布的变化而导致架构变动。
- **软件架构开发方法**；
  - 软件开发模型是跨越整个软件生存周期的，从开发、运行和维护所实施的全部工作和任务的结构框架。一般有三种：
    - 瀑布模型。以软件需求完全确认为前提。
    - 渐进式开发模型。如螺旋模型等，在软件开发初期只能提供基本需求为前提。
    - 变换模型。以形式化开发方法为基础。
- **架构风格**；
  - 架构风格（架构模式）是针对给定场景中经常出现的问题提供的一般性可重用方案，反映的是领域中众多系统中共有的结构和语义特征，并指导如何将各个子模块和子系统有效地组成一个完整的系统。分类：
    - 数据流风格。
    - 调用/返回风格。
    - 独立组件风格。
    - 虚拟机风格
    - 仓库风格。
- **动态软件架构**。

### 4.普及应用阶段（2000年至今）

软件架构是软件生命周期的重要产物，它影响软件开发的各个阶段：
- 需求阶段。
- 设计阶段。
- 实现阶段。
- 维护阶段。


## 软件架构的常用分类及建模方法

### 1.软件架构的常用分类

目前已形成的满足**不同用途**的架构模式，比较典型的有分层架构、事件驱动架构、微核架构、微服务架构和云架构等五类。此外像C/S、B/S、管道-过滤器和PAC等架构也是被广泛使用的。

#### 1.分层架构（LA）

Layered Architecture是最常见、也是事实上的标准架构。层与层之间通过接口进行通信，每一层都有清晰的角色和分工。

最常见的四层结构：

|层次|功能|
|---|---|
|表示层|用户界面、负责视觉和用户互动|
|业务层|实现业务逻辑|
|持久层|提供数据，SQL语句就在这一层|
|数据层|数据库保存数据|


有的项目在业务层和持久层之间加了一个服务层（Service），提供不同业务逻辑需要的一些通用接口。

#### 2.事件驱动架构（EDA）

Event-Driven Architecture，Event是状态发生变化时软件发出的通知。

事件驱动架构是**通过事件进行通信**的软件架构，是一种流行的**分布式异步架构**模式，适用于**松散耦合**系统。

![EDA架构](https://sustamp.github.io/assets/pictures/ruankao/EDA.png)


它分成四个部分：

|结构|名称|功能|
|---|---|---|
|1|事件队列|接收事件的入口|
|2|分发器|将不同事件分发到不同的业务逻辑单元|
|3|事件通道|分发器与处理器之间的连接通道|
|4|事件处理器|实现业务逻辑，处理完成后会发出事件，触发下一步操作|


对于简单的项目，事件队列、分发、通道可以合为一体，整个软件就分成**事件代理**和**事件处理**器两部分。

观察者模式常被叫做发布-订阅模式，事件驱动架构是观察者模式的一种最佳实践，常应用于商品系统，物流系统，监控系统，运营数据分析系统等。

#### 3.微核架构

微核架构（Microkernel Architecture）又称为插件架构（Plug-in Architecture），是指软件的内核相对较小，主要功能和业务逻辑都通过插件实现。

1. 核心系统（**内核**）：负责和具体业务功能无关的通用功能（系统运行的最小功能）。
   - 例如模块加载、模块间通信等。
2. **插件**模块：负责实现具体的业务逻辑。
   - 插件之间的通信应该减少到最低，避免出现互相依赖的问题。

![微核架构](https://sustamp.github.io/assets/pictures/ruankao/Microkernel-Architecture.png)

#### 4.微服务架构

Microservices Architecture是SOA（Service-Oriented Architecture，服务导向架构）的升级。

每个服务都是一个**独立的部署**单元（Separately Deployed Unit）。这些单元都是**分布式**的，互相解耦，通过远程通信协议（如REST、SOAP）联系。

> **能拆就拆**成一个服务。

微服务架构分成三种实现模式：

|模式|介绍|
|---|---|
|RESTful API模式|服务通过API提供，云服务就属于这一类。|
|RESTful 应用模式|服务通过传统的网络协议或应用协议提供，背后通常是一个多功能的应用程序，常见于企业内部。|
|集中消息模式|采用消息代理（Message Broker）实现消息队列、负载均衡、统一日志和异常处理，缺点是会出现单点失败，消息代理可能要做成集群。|


#### 5.云架构

> IaaS、PaaS、SaaS

Cloud Architecture主要解决**拓展性**和**并发**的问题，是最容易拓展的架构。

它的高拓展性体现在将数据都复制到内存中，变成可复制的内存数据单元，然后将业务处理能力封装成一个个处理单元（Processing Unit）。
- 若访问量增加就增加处理单元。
- 若访问量减少就关闭处理单元。

由于没有中央数据库，所以拓展性的瓶颈就消失了。由于每个PU的数据都在内存中，需要进行数据持久化。云架构主要分成两部分：

|结构|功能|
|---|---|
|处理单元(Processing Unit)|实现业务逻辑|
|虚拟中间件(Virtual Middleware)|负责通信、保持会话控制、数据复制、分布式处理和处理单元的部署|

![微核架构](https://sustamp.github.io/assets/pictures/ruankao/Cloud-Architecture.png)

### 2.软件架构的常用建模方法
4种模型并不完全独立，通常需要互相组合来形成一个可以刻画软件架构的完整模型。

#### 1.结构模型
这是一个最直观、最普遍的建模方法。

此方法以架构的**构件**、**连接件**和**其他概念**来刻画结构。通过结构来反映系统的重要语义内容、包括配置、约束、隐含的假设条件、风格和性质。

研究结构模型的核心是**架构描述语言**。

#### 2.框架模型
框架更**侧重整体**的结构，但不太侧重结构的细节。

框架模型主要以一些特殊的问题为目标建立只针对和适应问题的结构。

#### 3.动态模型
动态模型是对结构或框架模型的补充。主要研究系统的**大颗粒**行为的性质。例如描述系统的重新配置和演化。

#### 4.过程模型
过程模型是研究构造系统的步骤和过程，其结构是遵循某些过程脚本的结果。

## 软件架构应用场景及未来发展
### 1.应用场景

|架构风格|应用场景|
|---|---|
|管道-过滤器风格|面向数据流的流入和流出，用于将系统分成若干独立的步骤|
|主程序/子系统和面向对象架构风格|用于对组件内部进行设计，如主程序调用子程序，对象调用对象|
|虚拟机风格|用于构造解释器和专家系统|
|C/S和B/S风格|适用于数据和处理分布在一定范围，通过网络连接构成的系统|
|平台/插件风格|用于具有插件拓展功能的应用程序|
|MVC风格|用于用交互设计的程序|
|SOA风格|用于企业集成等方面|
|C2风格|用于GUI软件开发，用于构建灵活和可拓展的应用系统等|

大型软件很少使用单一的架构风格，而是混合多种风格进行设计和开发。从不同视角描述大型软件系统的能力，并保证系统可靠性、可拓展性、可维护性等非功能属性的正确描述。

### 2.未来发展
架构发展的主线可以归纳为：
- 模块化编程/面向对象编程
- 构件技术
- 面向服务开发技术
- 云技术


## 第2章 计算机系统基础知识
计算机系统是指用于数据管理的计算机**硬件**、**软件**、及**网络**组成的系统。它是按照人的要求接受和存储信息，自动进行数据处理和计算，并输出结果的机器系统。

![计算机系统组成](https://sustamp.github.io/assets/pictures/ruankao/Composition-Computesystem.png)


### 2.1 计算机硬件

计算机硬件组成结构源于**冯·诺依曼计算机结构**。

#### 处理器

计算机系统运算和控制核心部件。

位宽：4位 -> 64位。

内核：单核 -> 多核、异构多核、众核。

**指令集**：复杂指令集(CISC), 精简指令集(RISC)。RISC为趋势，化繁为简。  

典型的处理器系统结构：

----指令部件  
---运算部件--寄存器--存储部件  
-----Cache部件--MMU部件  
--完成部件  
-----地址总线  
-----数据总线  

##### 专用处理器
随着时代发展而设计出的专用目的的处理器有：

|处理器|介绍|
|---|---|
|图形处理器(**GPU**)|Graphics Processing Unit，具有数百或数千个内核，经过优化可并行运行大量计算|
|数字信号处理器(**DSP**)|Digital Signal Processor采用**哈佛结构**，专用于实时处理数字信号|
|现场可编程逻辑门阵列(**FPGA**)|Field-Programmable Gate Array，是一种由用户进行编程配置的集成电路|

图形处理器近些年在深度学习和机器学习领域得到了广泛应用。

数字信号处理器：
- 将存储器空间划分成两个，分别存储程序和数据。
- 它们有两组总线连接到处理器核允许同时对它们进行访问，每个存储器独立编址,独立访问。

现场可编程逻辑门阵列的主要用途有：
- 硬件加速：FPGA加速特定计算任务，如图像处理、信号处理、加密算法等。
- 原型验证：在ASIC（Application-Specific Integrated Circuit，专用集成电路）设计过程中，FPGA常用于验证设计的正确性，因为它可以快速重新配置。
- 嵌入式系统：FPGA可以集成到嵌入式系统中，实现复杂的控制逻辑和数据处理功能。
- 通信系统：FPGA在通信系统中广泛应用，用于实现协议处理、信号调制解调等功能。
- 数据中心：在数据中心中，FPGA可以用于加速特定的计算任务，提高服务器的性能和效率。

#### 存储器
存储器利用半导体、光、磁等介质制成的用于存储数据的电子设备。根据存储器的硬件结构可分为：
- SRAM（静态随机存储器）
- DRAM（动态随机存储器）
- NVRAM（非易失性随机存储器）
- Flash、EPROM（可擦除的随机存储器）、Disk

计算机系统的存储器通常采用分层的层次结构（memory hierarchy）。

![内存层次结构](https://sustamp.github.io/assets/pictures/ruankao/memory-hierarchy.png)

按照与处理器的物理距离可分为4个层次：

|与处理器距离|介绍|
|---|---|
|片上缓存|在处理器核心直接集成的缓存。SRAM结构，容量小(16~512KB)，速度快|
|片外缓存|处理器核心外的缓存，需要经过交换互联开关访问。SRAM结构，容量大一些(256kb~4MB)，按照层级可分为L2Cache/L3Cache/平台Cache|
|主存(内存)|DRAM结构，以独立的部件/芯片存在，通过总线与处理器连接。DRAM依赖不断充电维持其数据，容量：数百M~数十GB|
|外存|磁盘、磁带、光盘和各类Flash等，这类设备访问速度慢，但容量大，且在掉电后能保持其数据|

> 外存储器使用年限：
> - Flash < 10年
> - 光盘 0 < y < n * 10年
> - 磁盘 > 10年
> - 磁带 > 30年

#### 总线

计算机**部件间**遵循某一特定协议实现**数据交换**的**形式**。按位置划分为：

|位置|作用|
|---|---|
|内总线|用于芯片内部互联|
|系统总线|计算机中CPU、主存、IO接口的总线|
|外部总线|又称为通信总线，是计算机板和外部设备之间，或计算机系统之间互联的总线。|


##### 总线性能指标
- 总线带宽
- 总线服务质量（QoS，Quality of Service）
- 总线时延
- 总线抖动


##### 总线种类
常见的有：

|种类|举例|
|---|---|
|串行总线|USB,SATA,CAN,RS-232,RS-485,RapidI0和以太网|
|并行总线|PCI,PCIe fn ATA|


#### 接口
计算机**不同层**之间的**通信规则**。例如有:
- 显示接口HDMI/DVI/VGA，
- 音频输入输出接口TRS/RCA/XLR，
- 网络接口 RJ45/FC，
- USB接口，
- SATA接口，
- 打印机接口等等。


#### 外部设备
外围设备，如鼠标，键盘，显示器，摄像头或其他移动穿戴设备。


### 2.2 计算机软件
软件是指在系统上运行的**程序**、相关**文档**和**数据**的**集合**。按作用和运行环境分为两大类：

|种类|说明|
|---|---|
|系统软件|为整个计算机系统配置的不依赖特定应用领域的**通用软件**，这些软件对计算机系统的硬、软件资源进行控制和管理，并未用户和其他软件提供服务|
|应用软件|为某类需要或解决某问题而设计的软件，如图像处理软件，财务软件，游戏软件等|


![软件层次](https://sustamp.github.io/assets/pictures/ruankao/software-hierarchy.png)


#### 2.2.1 操作系统
操作系统是计算机系统的**资源管理者**，包含对软、硬件资源实施管理的一组程序。旨在合理**共享和利用**资源，发挥工作**效率**，提升处理**性能**。

##### 1.操作系统的组成
操作系统的组成部分：
- **操作系统内核**
- 其他许多附加的配套软件。

操作系统内核指的是能提供如下功能的软件模块：
- 进程管理
- 存储管理
- 文件管理
- 设备管理


##### 2.操作系统的作用
1. **管理**计算中运行的程序和分配各种软硬件资源。
2. **提供**对用户友善的人机界面
3. 为应用程序的开发和运行提供一个高效率的**平台**。
4. 其他作用：辅导用户操作，监控系统性能等。

##### 3.操作系统的特征

||特征|说明|
|---|---|---|
|1|并发性|单核CPU的并发性是指在一段时间内，宏观上多个任务是并发执行的；多核CPU则可将多个程序分配到不同的CPU执行。|
|2|共享性|操作系统中的资源被多个并发进程共同使用，同时共享和互斥共享。|
|3|虚拟性|将物理实体变为逻辑上的多个对应物(1个硬盘分成C、D、E盘)，或把物理上的多个实体变为逻辑上一个对应物(2个8G内存组成16G内存)的技术|
|4|不确定性|多个进程并发执行，但具体到何时执行，何时完成的时间并不是确定的，经常可能要等待资源或事件的发生而获得CPU的执行能力，"走走停停"|


##### 4.操作系统的分类

|操作系统|要点|
|---|---|
|批处理系统|通常不具备交互性，分为**单道批处理**和**多道批处理**。通常是将设定好的一批作业交给系统操作员输入计算机后，由系统控制它们自动运行。典型产品IBM OS/360和OS/390|
|分时操作系统|允许多个用户同时访问计算机资源，将CPU的工作时间划分为许多很短的时间片，轮流分配给每个用户使用。4个特点：**多路性**、**独立性**、**交互性**和**及时性**|
|实时操作系统|对外来信息以**足够快**的速度进行处理，并在**被控对象允许的时间内**做出快速反应。对交付能力要求不大，但可靠性要保证。分为**实时控制系统**（数据采集、武器控制、飞机自动驾驶、导弹制导系统等）和**实时信息系统**（飞机订票系统，情报检索等）|
|网络操作系统|网络操作系统使联网计算机能方便而有效地**共享网络资源**|
|分布式操作系统|多个分散的计算机连接而成的计算机系统。是网络操作系统的更高级形式，同时还有透明性、可靠性和高性能等特性|
|微型计算机操作系统|简称微机操作系统，常用的有Windows、MacOS、Linux|
|嵌入式操作系统|运行在嵌入式智能设备中，主要特点是：**微型化**、**可定制**、**实时性**、**可靠性**、**易移植**|


> 相关说明：
> - 微型化：占用的资源和系统代码量少。
> - 可定制：能针对硬件变化进行结构与功能上的配置，以满足不同需要。
> - 实时性：嵌入式操作系统常用在需要**迅速响应的场合**（过程控制、数据采集、传输通信、多媒体信息及关键要害领域），所以对实时性要求较高。
> - 可靠性：系统构件、模块和体系结构必须达到应用的可靠性，必要时还要提供容错和防故障措施。
> - 易移植：屏蔽掉硬件差异，采用硬件抽象层和板级支撑包等底层设计技术。
  

#### 2.2.2 数据库
数据库是指长期存储在计算机内的，有组织的、统一管理的**相关数据的集合**。

##### 数据库的种类
目前最常见的是关系型数据库和非关系型数据库。

根据存储体系分类如下：

|数据库|说明|
|---|---|
|关系型数据库|二维表|
|键值对数据库|将数据存储为键值对集合，键作为唯一标识|
|列存储数据库|表中数据的存储形式为列|
|文档数据库|可存放并获取的文档，如XML,JSON,BSON等格式|
|搜索引擎数据库|应用在搜索引擎领域的数据存储形式，由于搜索引擎会爬去大量的数据，并以特定的格式进行存储，这样在检索的时候才能保证性能最优|


#### 2.2.3 文件系统
文件系统是指操作系统中实现文件统一管理的一组软件和相关数据的集合。

##### 1.文件的类型

- 用途分：
  - 系统文件、库文件、用户文件
- 保存期限分：
  - 临时文件、档案文件、永久文件
- 保护方式分：
  - 只读、读写、可执行文件
- UNIX系统分：
  - 普通文件、目录文件、设备文件
  
文件系统类型（或叫**磁盘格式**）：
- FAT
  - 文件分配表（File Allocation Table）的缩写。早期的文件系统技术，对文件名命名有诸多约束。
  - 目前基本不再使用。
- VFAT
- NTFS
  - New Technology File System，用在windows系统上，取代了老式的FAT文件系统。
  - NTFS文件系统所具备3个功能：错误预警功能、磁盘自我修复功能和日志功能。
- Ext2
  - Ext系列常用在linux和unix系统上。
- HPFS


```java
public enum FileSystemType {
  FAT,
  VFAT,
  //windows
  NTFS,
  //linux、unix
  Ext2,
  HPFS
  ;
}
```

##### 2.文件的结构和组织
###### 1.文件的逻辑结构
用户角度看到的文件组织形式（在哪个文件夹下叫什么名）。分2类:
- **有结构**的记录式文件。由一个以上的记录构成的文件。
- **无结构**的流式文件。它是一串顺序字符流构成的文件（字节流）。

###### 2.文件的物理结构
从实现角度看，指的是文件在文件存储器上的存放方式。

(1) **连续结构**（顺序结构）

将逻辑上连续的文件信息一次存放在连续编号的物理块上。只要知道文件的起始物理块号和文件的长度就可以很方便地进行文件读取。


(2) **链接结构** (串联结构)

将逻辑上连续的文件存放在不连续的物理块上，每个物理块设有一个指针指向下一个物理块。

因此，只要知道文件的第1个物理块号，就可以按链指针找到整个文件。

(3) **索引结构**

将逻辑上连续的文件信息存放在不连续的物理块上，系统为每个文件建立一张索引表。

索引表记录了文件信息所在的逻辑块号对应的物理块号，并将索引表的起始地址放在与文件对应的文件目录项中。

(4) **多个物理块的索引表**

索引表是在文件创建时由系统自动建立的，并与文件一起存放在同一文件卷中。

根据一个文件大小的不同，索引表占用物理块的个数不等。多个物理块的索引表有2种组织形式：
- 链接文件
- 多重索引方式

> 文件索引节点法计算方法？


##### 3.文件的存取方法
文件的存取方法是指读/写文件存储器上的一个物理块的方法。通常是：
- 顺序读取
- 随机读取

##### 4.存储空间的管理
###### 1.空闲区表
将外存空间上的一个**连续未分配区域**叫做空闲区。适用于文件连续结构

###### 2.位示图（BitMap）
在外存上建立一张位示图，记录文件存储器的使用情况。每一位对应文件存储器上的一个物理块：
- 0：空闲。
- 1：占用。

> 考点：3星

![文件存储-位示图](https://sustamp.github.io/assets/pictures/ruankao/File-Bitmap.png)

上图所示的位示图中：
1. 字编号从1开始的。每个字字长=16位。
2. 位数编号从0开始，每1位表示一个物理块，即物理块的编号从0开始的。


###### 3.空闲块链
每个空闲物理块有指向下一个空闲物理块的指针，所有空闲物理块构成一个链表。

链表的头指针放在文件存储器的特定位置上（如管理块中），不需要磁盘分配表，节省空间。

每次申请空闲物理块只需根据链表的头指针取出第1个空闲物理块，第1个空闲物理块有指针可找到第2个空闲物理块，依次类推。

###### 4.成组链接法
Unix系统采用该方法。

在实现时系统将空闲块分成若干组，例如每100个空闲块为1组，每组的第1个空闲块登记下一组空闲块的物理编号和空闲块总数。假如某个组的第1个空闲块号等于0，则表示这是最后一组。


##### 5.文件共享和保护
###### 文件共享
文件共享是指不同用户进程使用同一文件，它不仅是不同用户完成同一任务所必须的功能，还可以节省大量主存空间，减少由于文件复制而增加的访问次数。

使用**文件链接**的方式实现文件共享：
- **硬链接**：不同文件名与同一个文件实体的链接。
  - 也叫基于**索引节点**的链接，不利于owner删除它拥有的文件（必须先删除所有的硬链接）。
- **符号链接**：建立新的文件和目录，与原来文件或目录的路径名进行映射。
  - 采用符号链接可以跨越文件系统，甚至可以通过计算机网络连接到世界上任何地方的机器中的文件，此时只需提供该文件所在的地址以及在该机器中的文件路径。

###### 文件的保护
文件的保护采用**存取控制**的方式进行。所谓存取控制，就是**规定**不同的用户对文件的访问有**不同的权限**，防止文件被未经主人同意的用户访问。

1. 存取控制矩阵：按个人划分权限，但是太大。
2. 存取控制表：按用户分类做权限控制。
3. 用户权限表：以用户或**用户组**为单位将用户可存取的文件集中起来存入表中。（存取控制矩阵的改进）
4. 密码：创建文件时，由用户提供一个密码，在文件存入磁盘时用密码对文件内容加密。
  

#### 2.2.4 网络协议
**不同**系统或**终端**之间要实现信息交换或资源分享，需要具备**共同能够理解的语言**，这就是网络协议。

网络协议规定了通信时的数据格式、传送时序、控制信息、应答信号等内容。

常用的网络协议有：
- LAN、WAN、WIFI、移动网协议
- 互联网使用的是TCP/IP协议族。


#### 2.2.5 中间件
承担应用软件在不同系统上可顺利运行的中介，所以叫中间件，它作为应用软件与各种操作系统之间使用的**标准化**编程**接口和协议**。

![中间件的位置](https://sustamp.github.io/assets/pictures/ruankao/Middleware.png)

中间件分类：
1. 消息中间件。
   - 如IBMMQ，ActiveMQ，Kafka等。
   - 建网和制定出通信协议，以保证系统能在不同平台之间通信，实现分布式系统中可靠、高效、实时的跨平台数据传输。
2. 事务处理（交易）中间件。
   - 每项事务在多台应用服务器间协调完成。如Tuxedo。
3. 数据存取中间件。
   - 经常用于分布式系统中，为虚拟缓冲存取、格式转换、解压等带来方便。
4. Web服务器中间件。
5. 安全中间件。
6. 跨平台和架构的中间件。
7. 专用平台中间件。
8. 网络中间件。
   - 包括网关、接入、网络测试、虚拟社区和虚拟缓冲等。
  
#### 2.2.6 软件构件
构件：也叫组件，是一个**自包容**、**可重用**的程序集。

构件提供接口供外部来访问。（外部不能直接操作构件的内部）

构件是独立的，因此架构的开发也是独立的，构件之间通过接口相互协作。

> 乐高积木？


##### 1.软件构件的组装模型

搭积木式的开发，即构件组装。

###### 构架组装的流程

|流程|任务|
|---|---|
|1|需求分析|
|2|设计构件组装（明确各构件之间的关系）|
|3|建立构件库|
|4|构建应用构件（独立开发、重用、使用第三方构件等）|
|5|测试与发布|

###### 优点
- 自包容。
  - 构建之间通过接口访问，相互独立。
- 可重用。
  - 设计良好的构建容易被重用。降低开发成本。
- 颗粒度小。
  - 相对整个系统，构建颗粒度小，开发任务更加灵活，各个构建都可进行独立并行开发。
  
###### 缺点
- 需要**经验丰富**的架构设计师。
  - 否则结构设计不良，重用性也会降低。
- 性能上会有**让步**。
  - 考虑构建的独立性和重用性，会导致其他方面做出让步，最明显的就是性能。
- 有**学习成本**。
  - 需要程序员熟练掌握构件开发和组装。
- 软件**质量**不好控制。
  - 第三方的构件库质量会最终影响软件质量，而第三方构件库通常很难控制。（木桶原理：木桶容量是根据最短的那块木板决定的）

##### 2.商用构件的标准规范
###### CORBA
公共请求代理架构（CORBA， Common Object Request Broker Architecture）。主要有3个层次：

|层次|结构|作用|
|----|----|---|
|最上层|公共设施|定义了构建框架，提供可直接为业务对象使用的服务，规定业务对象有效协作所需的协定规则|
||公共对象服务|诸如并发服务、名字服务、事务（交易）服务、安全服务等|
|最底层|对象请求代理|是分布对象系统中的**软总线**，规定了分布对象的定义（接口）和语言映射，实现***对象间的通信**和互操作|

CORBA CCM (CORBA Components Model)：
- 一个用于开发和配置分布式应用服务器端**构件模型规范**。

主要包括3项内容：
1. 抽象构件模型：描述服务器端构件结构和构件间互操作的结构
2. 构件容器结构：提供通用的构件运行和管理环境，并支持对安全、事务、持久状态等系统服务的集成。
3. 构件的配置和打包规范：CCM使用打包技术来管理构件的二进制、多语言版本的可执行代码和配置信息，制定了构件包的具体内容和文档标准。


###### J2EE
EJB(Enterprise Java Beans，企业级Java Beans)的Bean可分为 `会话Bean` 和 `实体Bean`，前者维护会话，后者处理事务，通常由Servlet 负责与客户端通信，访问RJB，并把结果通过JSP产生页面返回给客户端。

> J2EE时代的框架流程： http请求 -> Servlet -> EJB bean -> JSP 

###### DNA

#### 2.2.7 应用软件
应用软件是指为**特定**的应用场景而**设计的软件**。

 应用软件按开发方式和适用范围分为：
 - 通用应用软件
 - 定制应用软件

### 2.3 嵌入式系统及软件

|结构|定义|
|---|---|
|嵌入式系统（Embedded System）|是为了**特定应用**而专门构建且将信息处理过程和物理过程紧密结合为一体的**专用**计算机系统。它对功能、可靠性、成本、体积、功耗、环境等综合性能要求严格。|
|嵌入式软件|是指可运行在嵌入式系统中的**程序代码**和帮助这些软件开发所用的**工具**或**环境**软件的总称。|


#### 2.3.1 嵌入式系统的组成及特点
##### 组成

|组成|说明|
|---|---|
|应用软件|最上层|
|支撑软件||
|嵌入式操作系统|与通用操作系统不同，它具备实时性、可剪裁性和安全性等特征|
|相关支撑硬件|除处理器外的其他硬件，包括存储器、输入输出设备、IO接口和网络总线|
|嵌入式处理器|比如ARM处理器|


> 1. 硬件：嵌入式处理器、支撑硬件
> 2. 软件：嵌入式操作系统、支撑软件、应用软件

  
嵌入式系统将**可配置**与**可裁剪**集成于一体，并具备相应的**安全性**。需要满足应用对**功能**、**成本**、**体积**、**可靠性**和**功耗**等方面的严格要求。

嵌入式系统是深埋于设备中，对设备的**各种传感器**进行管理和控制的系统。

##### 特点

|嵌入式系统|特点|说明|
|---|---|---|
|1|专用性强|面向特定应用需求|
|2|多学科技术融合|以应用技术为核心、计算机技术为基础、通信技术为载体、以消费类产品为对象，引入各类传感器，引入Internet网络技术作为连接|
|3|软硬一体，软件为主||
|4|占用资源少|微型化，只完成少数几个任务，不用通用CPU，比通用计算机资源少，成本低，结构简单|
|5|程序代码固化在非易失存储器中|编码体积小，固化是为了提高执行速度和系统可靠性|
|6|专门的开发工具和不同的环境|嵌入式系统本身不具备开发能力，开发和运行是在不同环境中进行的（**最大特点**）。开发环境为宿主机，运行环境为目标机|
|7|实时性强，对安全性和可靠性要求高|应用于**需要快速响应的场合**，并具备相应的安全性，实现可靠的功能|
|8|体积小、价格低、工艺先进、性价比高、系统配置要求低、实时性强|你这是总结？|


#### 2.3.2 嵌入式系统的分类

|角度|分类|说明|
|---|---|---|
|按用途||实时系统是指能够在**指定的时间内完成**系统功能，做出响应的系统|
||强实时系统（Hard Real-Time）|在deadline内必须完成|
||弱实时系统（Weak Real-Time）|deadline只是参考值|
||非实时系统||
|按安全性|||
||安全攸关系统（Safety-Critical / Life-Critical）|其不正确的功能或失效会导致人员伤亡、财产损失等严重后果的计算机系统，比如航天航空系统、飞行器|
||非安全攸关系统||

  
#### 2.3.3 嵌入式软件的组成及特点
下面介绍的嵌入式系统通用架构主要指**目标机环境**架构。

##### 1.嵌入式软件组成架构
嵌入式系统软件组成架构采用**层次化结构**，并具备**可配置**、**可剪裁**的能力

![嵌入式软件架构层次化结构](https://sustamp.github.io/assets/pictures/ruankao/EmbeddedSoftware-hierarchy.png)

|层次(5)|说明|
|---|---|
|应用层|嵌入式系统的具体应用|
|中间件层|独立于操作系统之上，在嵌入式系统中使用的产品主要是嵌入式数据库、OpenGL图形处理软件、JAVA中间件、虚拟机等|
|操作系统层|操作系统层由嵌入式操作系统、文件系统、图形用户接口、网络系统和通用组件等可配置模块组成。|
|抽象层|位于硬件层与软件层之间。主要是对硬件层的硬件进行抽象(HAL)，为上层的软件层（操作系统）**提供虚拟的硬件资源**，其中最核心的东西是板级支持包（BSP）。|
|硬件层|为嵌入式系统提供运行支撑的**硬件环境**，其核心是微处理器、存储器、IO接口和通用设备以及总线、店员、时钟等。|

> - 硬件抽象层（HAL）：Hardware Abstract Layer。
> - 板级支持包（BSP）：Board Support Package，是一种硬件驱动软件，面向硬件芯片或电路进行驱动，为操作系统提供对硬件的管理。


##### 2.嵌入式软件的特点
外部环境的变化会对系统硬件性能产生影响，硬件的变化必然会引起软件的反常。

比如，航天领域的辐射会引起存储器的负离子反转，那么存储数据就会发生变化。因此嵌入式软件也要适用恶劣环境的影响。

嵌入式软件的主要特点如下：

|嵌入式软件|特点|说明|
|---|---|---|
|1|可剪裁性|根据系统需求，进行适应性功能的加、减。（**想要的留下，不想要的删掉**）。方法：*静态编译、动态库、控制函数流程等*|
|2|可配置性|根据系统运行状态、容量、流程对软件功能进行拓展、变更和增量服务（**可变**）。方法：*数据驱动、静态编译、配置表等*|
|3|强实时性|嵌入式系统大多数属于**强实时性系统**，要求任务在规定的时限(Deadline)内完成。**算法优劣**是影响实时性的主要原因|
|4|可靠性|在系统规定的条件和时间周期内让**程序正常**执行的能力。方法：*容错技术、余度技术和鲁棒性设计*|
|5|安全性|系统在规定的条件和时间周期内**不出事**的能力。方法：*编码标准、安全保障机制、FMECA*|
|6|高确定性|系统行为是预先设计规划好的，不能因为时间、状态变化而变化（**行为不变**）。运行期间不能发生资源枯竭和未知状态出现，尤其是不能因未知错误引发灾难。方法：*静态分配资源、越界检查、状态机、静态任务调度等*|

> - FMECA：故障模式`failure mode`、影响及危害性分析`effects and criticality analysis`

  
##### 3.嵌入式软件开发与传统软件开发的差异

1. 嵌入式软件开发是在宿主机（PC或工作站）上使用专门的嵌入式工具开发，生成二进制代码后，需要使用工具卸载到目标机或固化在目标机主存器上运行。
2. 嵌入式软件开发更强调软/硬件协同工作的**效率和稳定性**。
3. 嵌入式软件对实时性、安全性和可靠性的要求更高
4. 嵌入式软件需要充分考虑代码规模。
5. 在Life-Critical的嵌入式系统中，其开发还要满足某些领域的设计和代码审定。
6. 嵌入式系统对模块化设计的要求更高，划分好的模块和子系统，有助于实现嵌入式系统的可配置和可剪裁的特点。

#### 2.3.4 安全攸关软件的安全性设计
安全有关软件的定义：
- 用于一个系统中，可能导致不可接受的风险的软件。
  
在**航天航空**、**轨道交通**、**核工业**等领域，系统的安全报障是至关重要的（D0-178标准）。D0-178的精髓贯穿在整个软件生命周期的各个过程之中，它主要有3个因素：
1. 目标
2. 过程
3. 数据

##### 1.目标

|等级|失效状态|说明|目标数量|
|---|---|---|---|
|A级|灾难性的|软件异常导致的后果：航空器**无法**安全飞行和着陆|66|
|B级|危害性的|软件异常导致的后果：**严重**降低航空器克服不利运行情况时的能力|65|
|C级|严重的|软件异常导致的后果：**显著**降低了航空器克服不利运行情况时的能力|56|
|D级|不严重的|软件异常导致的后果：**轻微**降低了航空器克服不利运行情况时的能力|28|
|E级|没有影响的|软件异常导致的后果：不影响航空器的任何能力|0|

##### 2.过程
D0-178B把软件生命周期分为3个主要过程：
1. （软件）计划过程。
2. （软件）开发过程：
   1. 软件需求过程
   2. 软件设计过程
   3. 软件编码过程
   4. 软件集成过程
3. （软件）综合过程：
   1. 软件验证过程
   2. 软件配置管理过程
   3. 软件质量保证过程
   4. 审定联络过程


##### 3.数据
软件生命周期中产生的文档、代码、报表、记录等所有产品统称为软件生命周期数据。

> 需求文档、技术文档？ -> 代码开发 -> 业务报表 -> 日志记录、故障记录？


### 2.4 计算机网络
#### 计算机网络发展的四个阶段
#### 计算机网络的基本功能
1. 数据通信
2. 资源共享
3. 管理集中化
4. 实现分布式处理
5. 负载均衡

#### 2.网络有关指标
##### 性能指标

![网络性能指标概念示意图](https://sustamp.github.io/assets/pictures/ruankao/Network-Performance-Metrics.png)


|性能指标|说明|备注|
|---|---|---|
|速率|网速，在数字信道上传输的速率，单位：b/s||
|带宽|1.网络在**单位时间内可以传输的最大数据量**（水管容量），单位：b/s; 1.信号频道带宽，单位：Hz。||
|吞吐量|网络在**单位时间内实际传输的数据量**（从管道中流出的水）。受带宽或网络额定速率影响，吞吐量永远不会超过带宽||
|时延|数据从网络的一端传送到另一端所需的时间。（**水从一端到另一端的时间**）||
||发送时延|又称传输时延，至从数据块的第一个bit开始算起，到最后一个bit发完所需的时间|
||传播时延|电/光信号在传输**介质中传播**一定距离所要的时间|
||处理时延|检查分组首部和决定分组导向何处所需的时间|
||排队时延|在队列中，分组在等待传输时的时间|
|往返时间（RTT）|从发送方发送数据开始，到发送方接收到来自接收方的确认数据总共经历的时间||
|利用率|信道在60分钟内一直等待数据传输，但只有10分钟内有数据通过，信道利用率: 1/6||
||信道利用率|信道被利用的概率（即有数据通过），空闲信道的信道利用率为：0%|
||网络利用率|指全网络的信道利用率的加权平均值|

> - RTT：Round Trip Time


##### 非性能指标
1. 费用
2. 质量
3. 标准化
4. 可靠性
5. 可拓展性和可升级性
6. 易管理和维护


#### 通信技术
通信技术是计算机网络的基础，将数据从一个节点传送到另一个节点。

##### 信道

信道分为：
- 物理信道：由传输介质和设备组成，根据传输介质不同分为：有限信道和无限信道。
- 逻辑信道：以物理信道为载体，指在数据发送端和接收端之间的一条虚拟线路。

##### 1.香农公式
信道容量就是信道的最大传输功率，可通过香农公式计算得到：

```math
C = B * log_2(1 + S/N)
```

> - C：Capacity，信道容量，单位：b/s。
> - B：Bandwidth，信道带宽，单位：Hz。
> - S：Singal，信号平均功率，单位：W。
> - N：Noise，噪声平均功率，单位：W。
> - S/N：信道噪声比（信噪比），单位：dB。

##### 信号变换



##### 复用和多址
复用技术是指在一条信道上同时传输**多路数据**的技术。
- 如TDM时分复用、FDM频分复用和CDM码分复用。
- ADSL使用了FDM的技术，语音的上行和下行占用了不同的带宽。

多址技术是指在一条信道上同时传输**多个用户数据**的技术，在接收端把多个用户的数据分离。
- TDMA时分多址、FDMA频分多址、CDMA码多址。

> - M：Multiple?
> - T：Time?
> - F: Frequency?
> - C: Code?
> - A: Address?

##### 5G通信网
5G网络的主要特征：
1. 服务化架构：SBA服务架构，实现网络功能的灵活定制和按需组合。
2. 网络切片：在单个独立的物理网络切分出多个逻辑网络，从而避免为每个服务建设一个专用的物理网络，极大地降低了建网和运维成本。（类似于在服务器新增多个虚拟机？一个虚拟机出故障不影响其他虚拟机）

> SBA：Service-Based Architecture


#### 1.5.3 网络技术
网络按照覆盖区域和通信介质等特征可以分为：
- LAN
- WLAN
- MAN
- WAN
- 移动通信网

##### 局域网（LAN）（五类拓扑和以太网技术）
LAN（Local Area Network）是指在有限地理范围将若干计算机通过传输介质互联成的计算机组（通信网络），通过网络软件实现计算机之间的文件管理、应用软件共享、打印机共享、工作组内的日程安排、电子邮件和传真通信服务等功能。

局域网专用性非常强，具有比较稳定和规范的拓扑结构。常见的有：
- 星状拓扑
- 树状结构
- 总线结构
- 环形结构

###### 星状拓扑

![星状结构网络](https://sustamp.github.io/assets/pictures/ruankao/Star-Topology.png)

> - 一个中心节点（控制中心），任意两节点间通信最多只需2步。
> - 优点：传输速度快、网络结构简单、建网容易、便于控制和管理。
> - 缺点：可靠性低、网络共享能力差。一旦中心节点故障则全网瘫痪。

###### 树状结构

![星状结构网络](https://sustamp.github.io/assets/pictures/ruankao/Tree-Topology.png)



##### 无线局域网（WLAN）（WLAN标准和三类拓扑）
##### 广域网（WAN）（特点、分类和相关技术）
##### 城域网（MAN）
##### 移动通信网（发展、特征和服务化架构）
#### 1.5.4 组网技术
##### 网络设备（基本网络设备：集线器、中继器、网桥、交换机、路由器和防火墙等）
##### 交换技术、路由技术及相关协议
##### 开放系统互联参考模型（OSI/RM）
- 分层参考模型
- OSI协议集
- TCP/IP协议集
- 协议集比较





### 计算机语言

### 多媒体

### 系统工程

### 系统性能


## 架构风格
软件架构风格是描述某一特定领域中**系统组织方式**的惯用**模式**。

### 主要特征
架构风格定义了一类架构所共有的特征，主要包括：
- 架构定义
- 架构**词汇表**
- 架构**约束**
  
#### 架构定义
...

#### 架构词汇表
词汇表定义了架构中允许使用的组件类型和连接器类型。

#### 架构约束
架构约束定义了组件和连接器之间的合法关系和行为规则。
- 组件约束：
  - 定义组件的行为和属性。例如，组件必须提供特定的接口，组件的状态必须满足某些条件等。
- 连接器约束：
  - 定义连接器的行为和属性。例如，连接器必须支持特定的通信协议，连接器的延迟必须在一定范围内等。
- 配置约束：
  - 定义组件和连接器之间的合法配置。例如，某些类型的组件只能通过特定类型的连接器通信，某些组件不能直接通信等。

#### 举例
1. 分层架构：
   - 词汇表：
     - 组件：`表示层`、`业务层`、`持久层`、`数据层`。
     - 连接器：`接口调用`、`数据库查询`。
   - 约束：
     - 组件约束：每一层只能与其相邻层通信，不能跳过中间层直接通信。
     - 连接器约束：表示层只能通过`接口调用`业务层，业务层只能通过接口调用持久层，持久层只能通过`数据库查询`数据层。
     - 配置约束：`表示层`不能直接访问`数据层`，必须通过`业务层`和`持久层`。

2. 事件驱动架构：
   - 词汇表：
     - 组件：`事件生产者`、`事件处理器`。
     - 连接器：`事件队列`、`事件通道`。
   - 约束：
     - 组件约束：`事件生产者`负责生成事件，`事件处理器`负责处理事件。
     - 连接器约束：`事件队列`负责接收和存储事件，`事件通道`负责分发传输事件到`事件处理器`。
     - 配置约束：`事件生产者`通过`事件队列`、`事件通道`与`事件处理器`通信，不能直接调用。

3. 微服务架构：
   - 词汇表：
     - 组件：独立的`服务`。
     - 连接器：`HTTP/REST`、`消息队列`
   - 约束：
     - 组件约束：每个`服务`必须是独立部署的单元，每个服务负责一个特定的业务功能。
     - 连接器约束：`服务`之间通过`HTTP/REST`或`消息队列`进行通信，通信协议必须标准化。
     - 配置约束：`服务`之间必须松耦合，`服务`的变更不应影响其他服务的正常运行。


### 基于规则的系统
#### 整体流程(7步走)

|步骤|描述|
|---|---|
|1|需求分析|
|2|规则定义|
|3|规则引擎选择|
|4|规则存储与检索|
|5|规则执行|
|6|规则更新与维护|
|7|性能评估与优化|

##### 1.需求分析
在这一步需要明确系统需要实现的功能和规则。例如，一个贷款审批系统需要根据申请人的年龄、收入、信用记录等条件来判断是否批准贷款。
##### 2.规则定义
定义规则是实现基于规则系统的关键。规则通常以 `如果…那么…` 的形式表达。例如：

```
if age > 18 and income > 30000 and credit_score > 700:
  approve_loan()
```

##### 3.规则引擎选择
选择一个合适的规则引擎对于实现基于规则的系统至关重要。常见的规则引擎有Drools、Jess等。

##### 4.规则存储与检索
规则需要存储在某种形式的存储系统中，如数据库或文件系统。以下是一个简单的规则存储示例：

```json
rules = [
  {
    "condition": "age > 18", 
    "action": "approve_loan"
  }
]
```

##### 5.规则执行
在这一步，我们需要编写代码来执行定义好的规则。以下是一个简单的规则执行示例：

```
def execute_rules(person):
  for rule in rules:
    if eval (rule["condition"]):
      eval (rule["action"])
```


##### 6.规则更新与维护
##### 7.规则评估与优化


## 未来信息技术
### 信息物理系统
信息物理系统(Cyber-Physical System, CPS)是嵌入式系统、控制系统的拓展和延伸。

- **定义**：
  - CPS是以先进的**感知**与**3C技术**构建物理空间和信息空间中人、机、物、环境、信息等要素相互映射、适时交互、高效协同的复杂系统。
  - 实现系统内资源配置和运行的按需响应、快速迭代、动态优化。
- **本质**：
  - 构建一套物理空间和信息空间之间基于**数据自动流动**的状态**感知**、实时**分析**、科学**决策**、精准**执行**的闭环赋能系统。
  - 解决**生产制造**、**应用服务**过程中的**复杂性**和**不确定性**问题。
  - 提高资源配置效率，实现资源优化。

> - Cyber：
>   - adj. 赛博，与网络有关的。  
> - 3C：
>   - Computation、Comunication、Control，即计算、通信、控制。

#### 结构、安全威胁及防护

|层次|含义|安全威胁|防护|
|---|---|---|---|
|感知层|由传感器、控制器、采集器等组成；属于物理信息系统中的末端设备|感知数据破坏、信息窃听、节点捕获|加强传感器的安全防护，提高传感器的安全性和可靠性|
|网络层|联系物理空间和信息空间的桥梁，实现数据传输，为系统提供实时的网络服务|拒绝性服务攻击、选择性转发、方向误导攻击|加密技术和安全协议保护数据传输的安全|
|控制层|根据认知结果和物理设备传回的信息进行数据分析，并将结果返回给客户端|用户信息泄露、恶意代码、非授权访问|认证和授权等安全管理机制和应急响应机制|

#### 应用场景
1. 智能家居：
   - CPS可以实现家店的远程控制和智能化管理。
2. 工业自动化:
   - CPS可以提高生产效率和产品质量，实现生产过程中的**自动化**和**智能化**。
3. 智能交通：
   - CPS可以实现交通流量的实时监测和智能调度，提高交通运行效率和安全性。


